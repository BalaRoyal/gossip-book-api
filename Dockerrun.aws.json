{
  "AWSEBDockerrunVersion": 2,
  "containerDefinitions": [
    {
      "command": [
        "daphne",
        "gossips_book.asgi:application",
        "-b",
        "0.0.0.0",
        "-p",
        "5000"
      ],
      "essential": false,
      "memory": 128,
      "name": "asgi_api",
      "image": "271279667713.dkr.ecr.us-east-1.amazonaws.com/backend_asgi:latest",
      "links": ["redis-server", "db"],
      "hostName": "asgi_api",
      "portMappings": [
        {
          "hostPort": 5000,
          "containerPort": 5000
        }
      ]
    },
    {
      "environment": [
        {
          "name": "POSTGRES_PASSWORD",
          "value": "password"
        },
        {
          "name": "POSTGRES_USER",
          "value": "gossip_book"
        },
        {
          "name": "POSTGRES_DB",
          "value": "gossip_book"
        }
      ],
      "essential": false,
      "memory": 128,
      "image": "postgres:latest",
      "name": "db",
      "hostName": "db"
    },
    {
      "essential": true,
      "memory": 128,
      "mountPoints": [
        {
          "containerPath": "/home/app/api/staticfiles",
          "sourceVolume": "Static_Volume"
        }
      ],
      "name": "nginx",
      "image": "271279667713.dkr.ecr.us-east-1.amazonaws.com/nginx-proxy:latest",
      "portMappings": [
        {
          "containerPort": 80,
          "hostPort": 80
        }
      ],
      "links": ["asgi_api", "wsgi_api"]
    },
    {
      "essential": true,
      "memory": 128,
      "image": "redis:latest",
      "name": "redis-server",
      "hostName": "redis-server"
    },
    {
      "command": [
        "sh",
        "-c",
        "python manage.py migrate && gunicorn gossips_book.wsgi:application --bind 0.0.0.0:8000"
      ],
      "essential": false,
      "memory": 128,
      "hostName": "wsgi_api",
      "portMappings": [
        {
          "containerPort": 8000,
          "hostPort": 8000
        }
      ],
      "mountPoints": [
        {
          "containerPath": "/home/app/api/staticfiles",
          "sourceVolume": "Static_Volume"
        },
        {
          "containerPath": "/home/app/api/mediafiles",
          "sourceVolume": "Media_Volume"
        }
      ],
      "name": "wsgi_api",
      "image": "271279667713.dkr.ecr.us-east-1.amazonaws.com/backend_wsgi",
      "links": ["redis-server", "db"]
    }
  ],
  "family": "",
  "volumes": [
    {
      "host": {
        "sourcePath": "static_volume"
      },
      "name": "Static_Volume"
    },
    {
      "host": {
        "sourcePath": "media_volume"
      },
      "name": "Media_Volume"
    }
  ]
}
